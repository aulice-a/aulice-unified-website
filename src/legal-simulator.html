---
layout: base.html
title: Legal Professionals Simulator
permalink: /legal-simulator/
---

<div class="legal-course bg-gray-100 flex flex-col items-center min-h-screen">
    <header class="fixed top-0 left-0 right-0 z-50 bg-white shadow-lg py-4 px-8 flex justify-between items-center">
        <nav class="flex space-x-6 text-gray-700 font-medium">
            <a href="https://www.aulice.ca/" target="_blank" class="hover:text-gray-800 transition-colors duration-200">Gate</a>
            <a href="https://aulice-about.netlify.app/" target="_blank" class="hover:text-gray-800 transition-colors duration-200">About us</a>
            <a href="https://aulice-pricing-plans.netlify.app/" target="_blank" class="hover:text-gray-800 transition-colors duration-200">Pricing Plans</a>
            <a href="https://aulice-lexicon.netlify.app/" target="_blank" class="hover:text-gray-800 transition-colors duration-200">Lexicon</a>
            <a href="https://aulice-teacher-dashboard.netlify.app/" target="_blank" class="hover:text-gray-800 transition-colors duration-200">Teacher</a>
            <a href="https://aulice-contact.netlify.app/" target="_blank" class="hover:text-gray-800 transition-colors duration-200">Contact</a>
        </nav>
        <button id="share-btn" class="text-white font-semibold py-2 px-4 rounded-lg shadow-md transition-colors" style="background-color: var(--course-primary-color);">
            Share
        </button>
    </header>

    <div class="container mx-auto p-8 bg-white shadow-2xl rounded-2xl border border-gray-200 mt-20 mb-8">
        <div id="game-container">
            <header class="text-center mb-8">
                <h1 class="text-4xl font-bold text-gray-800">Legal Professionals Simulator</h1>
                <p class="text-lg text-gray-500 mt-2">Navigate challenging legal and ethical dilemmas.</p>
            </header>

            <main class="grid grid-cols-1 md:grid-cols-2 gap-8">
                <div class="bg-gray-50 p-6 rounded-xl border border-gray-200 shadow-inner flex flex-col justify-between">
                    <div>
                        <h2 class="text-2xl font-semibold text-gray-700 mb-4">Situation <span id="situation-number">1</span>/10</h2>
                        <div class="scrollable-content">
                            <p id="situation-text" class="text-gray-600 leading-relaxed text-base fade-in">
                                </p>
                        </div>
                    </div>
                    <div class="mt-6 text-center">
                        <p class="text-2xl font-extrabold" style="color: var(--course-primary-color);">Score: <span id="score">100</span></p>
                        <p id="score-change-indicator" class="text-sm font-semibold mt-1 opacity-0 score-change">
                            </p>
                    </div>
                </div>

                <div class="flex flex-col">
                    <div id="option-buttons-container" class="grid grid-cols-1 gap-4 mb-6">
                        <button class="option-btn text-white font-semibold py-3 px-6 rounded-lg shadow-md transition-colors transform hover:scale-105 duration-200" style="background-color: var(--course-primary-color);" data-option-index="0">Option 1</button>
                        <button class="option-btn text-white font-semibold py-3 px-6 rounded-lg shadow-md transition-colors transform hover:scale-105 duration-200" style="background-color: var(--course-primary-color);" data-option-index="1">Option 2</button>
                        <button class="option-btn text-white font-semibold py-3 px-6 rounded-lg shadow-md transition-colors transform hover:scale-105 duration-200" style="background-color: var(--course-primary-color);" data-option-index="2">Option 3</button>
                        <button class="option-btn text-white font-semibold py-3 px-6 rounded-lg shadow-md transition-colors transform hover:scale-105 duration-200" style="background-color: var(--course-primary-color);" data-option-index="3">Option 4</button>
                    </div>
                    
                    <div id="outcome-container" class="bg-gray-50 p-6 rounded-xl border border-gray-200 shadow-inner hidden fade-in">
                        <h3 class="text-xl font-semibold text-gray-700 mb-2">Outcome:</h3>
                        <p id="outcome-text" class="text-gray-600 leading-relaxed text-base">
                            </p>
                    </div>

                    <div id="final-buttons" class="flex flex-col md:flex-row gap-4 mt-6">
                        <button id="next-situation-btn" class="flex-1 bg-green-500 text-white font-semibold py-3 px-6 rounded-lg shadow-md hover:bg-green-600 transition-colors transform hover:scale-105 duration-200 hidden">Next Situation</button>
                    </div>
                </div>
            </main>
        </div>

        <div id="shared-score-container" class="text-center p-8 hidden">
            <h2 class="text-5xl font-extrabold text-gray-800 mb-4">Legal Professionals Simulator</h2>
            <p class="text-2xl font-medium text-gray-600 mb-2">Someone wants to share their score with you!</p>
            <p class="text-7xl font-black mt-8 mb-8" style="color: var(--course-primary-color);">Score: <span id="shared-score"></span></p>
            <p class="text-lg text-gray-500 max-w-md mx-auto mb-8">This is the final score they achieved. Are you ready to beat it?</p>
            <button id="play-now-btn" class="text-white font-semibold py-3 px-8 rounded-full shadow-lg transition-colors transform hover:scale-105 duration-200" style="background-color: var(--course-primary-color);">Play Now!</button>
        </div>

        <div id="message-modal" class="fixed inset-0 bg-gray-900 bg-opacity-50 flex items-center justify-center hidden z-50">
            <div class="bg-white p-6 rounded-xl shadow-2xl max-w-sm w-full text-center">
                <h3 class="text-xl font-bold text-gray-800 mb-4">Link Copied!</h3>
                <p class="text-gray-600 mb-6">The shareable link has been copied to your clipboard. Share it with your friends!</p>
                <button id="close-modal-btn" class="text-white font-semibold py-2 px-6 rounded-lg transition-colors" style="background-color: var(--course-primary-color);">Close</button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // Utility function to shuffle an array (Fisher-Yates)
            function shuffleArray(array) {
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
                return array;
            }

            const situations = [
                {
                    title: "The Client's Intent",
                    situation: "During a private consultation, your client confides that they intend to destroy a critical piece of evidence related to their case. The evidence is not yet in the possession of the court or opposing counsel.",
                    options: [
                        { text: "Advise the client that destroying evidence is a criminal offense and instruct them to preserve it. If they refuse, you must withdraw from the case.", outcome: "You uphold your ethical duty to the court. You cannot assist a client in a criminal act, and you must withdraw if they insist on a course of action that violates the law. This is the correct and ethical course of action.", scoreChange: +40 },
                        { text: "Tell the client that since it's not in the court's possession yet, it's not a crime to destroy it and to go ahead.", outcome: "You are actively assisting in a criminal act and a felony. This would lead to your disbarment and a possible prison sentence. A catastrophic ethical failure.", scoreChange: -50 },
                        { text: "Ignore the statement and continue with the consultation, assuming the client won't follow through with their threat.", outcome: "You have a duty to not knowingly assist a client's criminal or fraudulent act. Ignoring this information puts you at risk of professional misconduct charges. A passive and irresponsible choice.", scoreChange: -30 },
                        { text: "Call the police and report your client's plan to destroy evidence.", outcome: "You are violating the attorney-client privilege. While some jurisdictions allow for exceptions regarding future crimes that pose a serious threat, destroying evidence does not meet that standard. A serious breach of confidentiality.", scoreChange: -30 }
                    ]
                },
                {
                    title: "The Misconduct of Opposing Counsel",
                    situation: "Opposing counsel sends you a series of aggressive, unprofessional, and insulting emails, including personal attacks, in an attempt to intimidate you and your client into settling.",
                    options: [
                        { text: "Maintain a calm and professional demeanor in your replies. Document every instance of misconduct and, if it continues, raise the issue with the presiding judge or a professional conduct board.", outcome: "You uphold your duty to professionalism and decorum. By documenting the behavior, you build a strong case for sanctions or intervention from the court, without lowering yourself to their level. This is the correct and professional choice.", scoreChange: +35 },
                        { text: "Reply with equally aggressive and insulting emails to show them you won't be intimidated.", outcome: "You are engaging in unprofessional conduct and potentially damaging your case. The court may view your behavior as equally egregious, leading to sanctions. An unprofessional and shortsighted choice.", scoreChange: -30 },
                        { text: "Report them to the professional conduct board immediately without trying to resolve the issue with the judge or them first.", outcome: "You are over-reacting. You should have attempted to address the issue with the judge or them first. An unprofessional and shortsighted choice.", scoreChange: -25 },
                        { text: "Ignore their emails and refuse to communicate with them until they apologize.", outcome: "You are not addressing a serious problem. You are showing a lack of professionalism and a fear of confrontation. A passive and unhelpful response.", scoreChange: -20 }
                    ]
                },
                {
                    title: "The Frivolous Lawsuit",
                    situation: "Your client insists on filing a lawsuit against their former business partner for a minor disagreement. You have reviewed the facts and the law, and you are convinced that the case has no legal merit and is intended only to harass the other party.",
                    options: [
                        { text: "Politely but firmly advise the client that you cannot ethically or legally file a lawsuit without merit. Explain the potential for sanctions against both of you and recommend alternative dispute resolution.", outcome: "You uphold your duty to the legal system. Lawyers have an obligation to only file claims that are legally and factually sound. You protect both your client and yourself from potential sanctions. This is the correct and professional choice.", scoreChange: +40 },
                        { text: "File the lawsuit as the client demands, believing that it will not be dismissed and that your client will eventually win.", outcome: "You are filing a frivolous lawsuit. This is a violation of legal ethics and can lead to sanctions against you and your client. An irresponsible and unprofessional choice.", scoreChange: -40 },
                        { text: "Tell the client that you are too busy and refer them to another lawyer who you know will take the case.", outcome: "You are not addressing the problem. You are attempting to hide a problem that will inevitably resurface. An unprofessional and shortsighted choice.", scoreChange: -25 },
                        { text: "Threaten to withdraw from the case if the client does not drop the lawsuit.", outcome: "You are not addressing a serious problem. You are showing a lack of professionalism and a fear of confrontation. A passive and unhelpful response.", scoreChange: -20 }
                    ]
                },
                {
                    title: "The Unjust Settlement",
                    situation: "You are negotiating a settlement for your client, who has been severely injured in a car accident. The insurance company offers a settlement that is far below what you believe the case is worth, but your client is desperate for money and wants to accept it immediately.",
                    options: [
                        { text: "Advise the client of the inadequacy of the offer, but also explain their right to accept it. You document your advice thoroughly and allow them to make the final decision.", outcome: "You fulfill your duty to provide competent counsel. The ultimate decision to settle a case rests with the client, and you have provided them with all the necessary information to make a well-informed choice. This is the correct and ethical choice.", scoreChange: +30 },
                        { text: "Threaten to withdraw from the case if the client accepts the settlement. You believe the offer is not fair.", outcome: "You are not respecting your client's autonomy. You are attempting to coerce them into a decision they do not want to make. An unprofessional and shortsighted choice.", scoreChange: -30 },
                        { text: "Refuse to communicate the offer to your client and demand a higher settlement from the insurance company.", outcome: "You are violating your duty to keep your client informed of all material developments in their case, including all settlement offers. An egregious breach of trust and a violation of ethics.", scoreChange: -40 },
                        { text: "Advise them to accept the settlement immediately, even though you believe it is not in their best interest.", outcome: "You are not fulfilling your duty to provide competent counsel. You are prioritizing your client's immediate needs over their long-term best interest. An unprofessional and shortsighted choice.", scoreChange: -25 }
                    ]
                },
                {
                    title: "The Witness Who Changed Their Story",
                    situation: "A key witness for your case has a private meeting with you. During the meeting, they tell you that the testimony they gave in their deposition was not entirely true. They are now worried about committing perjury.",
                    options: [
                        { text: "Advise the witness to immediately correct their testimony, explaining their legal and ethical obligations. You must then inform the court and opposing counsel of the change in testimony.", outcome: "You uphold your duty to the court and to the truth. You cannot knowingly present false testimony. You take action to correct the record and ensure the integrity of the legal process. This is the correct and professional choice.", scoreChange: +40 },
                        { text: "Tell the witness to stick to their original testimony and not to worry about it, as it will help your case.", outcome: "You are suborning perjury. This is a criminal act and a massive ethical failure. You would be disbarred and potentially face a prison sentence. A catastrophic and reckless decision.", scoreChange: -50 },
                        { text: "Tell the witness that you will not represent them anymore and to find a new lawyer.", outcome: "You are not addressing the problem. You are attempting to hide a problem that will inevitably resurface. An unprofessional and shortsighted choice.", scoreChange: -30 },
                        { text: "Tell the witness that you will not tell anyone what they told you and that their secret is safe with you.", outcome: "You are not addressing a serious problem. You are showing a lack of professionalism and a fear of confrontation. A passive and unhelpful response.", scoreChange: -20 }
                    ]
                },
                {
                    title: "The Accidental Discovery",
                    situation: "While reviewing documents from opposing counsel, you find a confidential memorandum that was clearly produced by mistake. The document contains a significant admission that would win your case.",
                    options: [
                        { text: "Immediately notify opposing counsel of the accidental production. Do not read the document or use its contents, and await their instructions on how to proceed.", outcome: "You uphold the highest standards of legal ethics and professional courtesy. You respect the opposing party's attorney-client privilege and avoid using a clear mistake to gain an unfair advantage. This is the correct and professional choice.", scoreChange: +40 },
                        { text: "Read the document, use its contents to your advantage, and don't tell anyone about it.", outcome: "You are violating the ethical rules of discovery. You are using a document that you know was accidentally produced and is protected by attorney-client privilege. An egregious breach of trust and a violation of ethics.", scoreChange: -50 },
                        { text: "Read the document and then send a copy to the judge, believing that it will help your case.", outcome: "You are not addressing the problem. You are showing a lack of professionalism and a fear of confrontation. A passive and unhelpful response.", scoreChange: -25 },
                        { text: "Tell your client about the accidental document, but do not use it in the case.", outcome: "You are not addressing a serious problem. You are showing a lack of professionalism and a fear of confrontation. A passive and unhelpful response.", scoreChange: -20 }
                    ]
                },
                {
                    title: "The Billing Dispute",
                    situation: "Your client receives a bill for a complex case and demands a detailed breakdown of every minute billed. They question a particular entry that was a result of a minor clerical error in your billing software.",
                    options: [
                        { text: "Provide a detailed breakdown of all services rendered, correct the clerical error on the disputed entry, and apologize for the mistake. You explain the complex billing process and offer to discuss any further questions.", outcome: "You demonstrate transparency and integrity. You correct your mistake, maintain your professional reputation, and ensure the client is fully informed, thereby protecting the attorney-client relationship. This is the correct and professional choice.", scoreChange: +30 },
                        { text: "Insist that the charge is correct and that the client is mistaken.", outcome: "You are not addressing the problem. You are showing a lack of professionalism and a fear of confrontation. A passive and unhelpful response.", scoreChange: -30 },
                        { text: "Yell at the client and tell them that you are too busy to go over every single entry on the bill.", outcome: "You are escalating the situation and putting yourself and others at risk. An unprofessional and dangerous choice.", scoreChange: -40 },
                        { text: "Tell the client that you will take care of it, but you don’t do anything.", outcome: "You are lying to the client and you do nothing to solve the problem. An unprofessional and dishonest choice.", scoreChange: -25 }
                    ]
                },
                {
                    title: "The Aggressive Opponent",
                    situation: "During a heated deposition, opposing counsel is being overtly aggressive, cutting off your witness, and making inappropriate remarks about your case. The witness is visibly flustered.",
                    options: [
                        { text: "Object to the aggressive line of questioning, instruct your witness not to answer a question that is harassing, and calmly state on the record that you will seek the judge’s intervention if the behavior continues.", outcome: "You protect your witness and the integrity of the deposition. You calmly enforce the rules of procedure and place the burden on opposing counsel to correct their behavior or face the judge. This is the correct and professional choice.", scoreChange: +35 },
                        { text: "Yell at the opposing counsel and threaten to end the deposition immediately.", outcome: "You are escalating the situation and putting yourself and others at risk. An unprofessional and dangerous choice.", scoreChange: -40 },
                        { text: "Tell the witness to answer the questions and to not worry about the opposing counsel's behavior.", outcome: "You are not addressing a serious problem. You are putting another person at risk. An irresponsible and unprofessional choice.", scoreChange: -25 },
                        { text: "Walk out of the deposition and refuse to participate.", outcome: "You are not addressing a serious problem. You are showing a lack of professionalism and a fear of confrontation. A passive and unhelpful response.", scoreChange: -20 }
                    ]
                },
                {
                    title: "The Unreasonable Demand",
                    situation: "Your client wants you to add a clause to a contract that you believe is unconscionable and legally indefensible. You have explained your concerns, but the client insists.",
                    options: [
                        { text: "Refuse to draft the unconscionable clause and explain that doing so would be a violation of professional ethics and could void the entire contract. If the client insists, you must withdraw from the case.", outcome: "You uphold your duty to the legal system and to your client's best interests. You cannot knowingly assist a client in drafting a contract that is legally indefensible. You protect yourself and your client from potential legal and ethical consequences. This is the correct and professional choice.", scoreChange: +40 },
                        { text: "Draft the clause as the client demands, believing that it will not be challenged.", outcome: "You are drafting a contract that you know is legally indefensible. This is a violation of legal ethics and can lead to sanctions against you and your client. An irresponsible and unprofessional choice.", scoreChange: -50 },
                        { text: "Tell the client that you are too busy and refer them to another lawyer who you know will take the case.", outcome: "You are not addressing the problem. You are attempting to hide a problem that will inevitably resurface. An unprofessional and shortsighted choice.", scoreChange: -30 },
                        { text: "Threaten to withdraw from the case if the client does not drop the lawsuit.", outcome: "You are not addressing a serious problem. You are showing a lack of professionalism and a fear of confrontation. A passive and unhelpful response.", scoreChange: -20 }
                    ]
                },
                {
                    title: "The Undisclosed Conflict of Interest",
                    situation: "A new client wants to hire you for a lawsuit against a company. You realize the opposing counsel is a close personal friend with whom you often socialize. You have no professional relationship with them outside of friendship.",
                    options: [
                        { text: "Immediately disclose the conflict to both your client and the opposing counsel in writing. Explain the potential for bias and allow them to decide if they want you to continue to represent the client.", outcome: "You uphold your duty to disclose all conflicts of interest, even if they are not explicitly forbidden by the rules of professional conduct. You are being transparent and ethical. This is the correct and professional choice.", scoreChange: +35 },
                        { text: "Tell your client that you are friends with the opposing counsel, but that you don't think it will be a problem.", outcome: "You are not addressing the problem. You are showing a lack of professionalism and a fear of confrontation. A passive and unhelpful response.", scoreChange: -25 },
                        { text: "Ignore the conflict and proceed with the case, believing that your friendship will not affect your professional judgment.", outcome: "You are putting yourself and your client at risk. An irresponsible and unprofessional choice.", scoreChange: -30 },
                        { text: "Tell the client that you are too busy and refer them to another lawyer who you know will take the case.", outcome: "You are not addressing the problem. You are attempting to hide a problem that will inevitably resurface. An unprofessional and shortsighted choice.", scoreChange: -20 }
                    ]
                }
            ];

            let score = 100;
            let currentSituationIndex = 0;
            let currentOptions = []; // Stores the shuffled options for the current question

            const scoreElement = document.getElementById('score');
            const situationNumberElement = document.getElementById('situation-number');
            const situationTextElement = document.getElementById('situation-text');
            const optionButtons = document.querySelectorAll('.option-btn');
            const outcomeContainer = document.getElementById('outcome-container');
            const outcomeTextElement = document.getElementById('outcome-text');
            const nextSituationBtn = document.getElementById('next-situation-btn');
            const scoreChangeIndicator = document.getElementById('score-change-indicator');
            const shareBtn = document.getElementById('share-btn');
            const gameContainer = document.getElementById('game-container');
            const sharedScoreContainer = document.getElementById('shared-score-container');
            const sharedScoreElement = document.getElementById('shared-score');
            const playNowBtn = document.getElementById('play-now-btn');
            const messageModal = document.getElementById('message-modal');
            const closeModalBtn = document.getElementById('close-modal-btn');
            const optionButtonsContainer = document.getElementById('option-buttons-container');

            // Function to update the score display with a transition
            function updateScoreDisplay(newScore, change) {
                const isPositive = change > 0;
                scoreElement.textContent = newScore;
                scoreChangeIndicator.textContent = `${isPositive ? '+' : ''}${change}`;
                scoreChangeIndicator.classList.remove('text-green-600', 'text-red-600', 'opacity-0');
                scoreChangeIndicator.classList.add(isPositive ? 'text-green-600' : 'text-red-600', 'fade-in');
                setTimeout(() => {
                    scoreChangeIndicator.classList.add('opacity-0');
                }, 1000);
            }

            // Function to load the current situation (UPDATED for randomization)
            function loadSituation() {
                if (currentSituationIndex >= situations.length) {
                    showFinalScore();
                    return;
                }
                const situation = situations[currentSituationIndex];
                
                // --- Shuffle the options for randomization ---
                currentOptions = shuffleArray([...situation.options]);
                // ---------------------------------------------
                
                // Hide outcome and button
                outcomeContainer.classList.add('hidden');
                nextSituationBtn.classList.add('hidden');
                optionButtonsContainer.classList.remove('hidden'); // Ensure options are visible

                // Reset buttons and their listeners
                optionButtons.forEach(btn => {
                    btn.disabled = false;
                    btn.classList.remove('bg-gray-400', 'cursor-not-allowed', 'opacity-50');
                    btn.classList.add('transition-colors', 'transform', 'hover:scale-105', 'duration-200');
                    // Ensure the inline style for course color is reset
                    btn.style.backgroundColor = 'var(--course-primary-color)'; 
                });
                
                // Set situation number and text
                situationNumberElement.textContent = currentSituationIndex + 1;
                situationTextElement.classList.remove('fade-in');
                void situationTextElement.offsetWidth; // Trigger reflow to restart animation
                situationTextElement.textContent = situation.situation;
                situationTextElement.classList.add('fade-in');

                // Set option button texts using the SHUFFLED array
                currentOptions.forEach((option, index) => {
                    optionButtons[index].textContent = option.text;
                });
            }

            // Function to handle option clicks (UPDATED for randomization)
            function handleOptionClick(event) {
                // Disable all option buttons after a choice is made
                optionButtons.forEach(btn => {
                    btn.disabled = true;
                    btn.classList.remove('transition-colors', 'transform', 'hover:scale-105', 'duration-200');
                    btn.classList.add('bg-gray-400', 'cursor-not-allowed', 'opacity-50');
                    // Remove inline style on disabled buttons for neutral gray look
                    btn.style.backgroundColor = ''; 
                });
                
                const optionIndex = parseInt(event.target.dataset.optionIndex, 10);
                
                // --- Use the SHUFFLED options array to get the result ---
                const chosenOption = currentOptions[optionIndex];
                // --------------------------------------------------------
                
                // Update score and display change
                score += chosenOption.scoreChange;
                updateScoreDisplay(score, chosenOption.scoreChange);

                // Display outcome
                outcomeTextElement.textContent = chosenOption.outcome;
                outcomeContainer.classList.remove('hidden');
                nextSituationBtn.classList.remove('hidden');
            }

            // --- UPDATED FINAL SCORE FUNCTION ---
            function showFinalScore() {
                // Save the final score and the profession to local storage
                localStorage.setItem('finalScore', score);
                localStorage.setItem('profession', 'Legal Professionals Simulator');
                
                // Redirect the user to the static results page
                window.location.href = `/leaderlab-results/?score=${score}`;
            }
            // ----------------------------------------------
            
            // Function to show the share modal
            function showShareModal() {
                messageModal.classList.remove('hidden');
            }

            // Function to handle the fallback for copying to clipboard
            function fallbackCopyTextToClipboard(text) {
                const textArea = document.createElement("textarea");
                textArea.value = text;
                textArea.style.position = "fixed";
                textArea.style.top = "0";
                textArea.style.left = "0";
                textArea.style.opacity = "0";
                document.body.appendChild(textArea);
                textArea.focus();
                textArea.select();
                try {
                    document.execCommand('copy');
                } catch (err) {
                    console.error('Fallback: Oops, unable to copy', err);
                }
                document.body.removeChild(textArea);
            }

            // Share button event listener
            shareBtn.addEventListener('click', () => {
                const link = window.location.href;
                if (navigator.clipboard) {
                    navigator.clipboard.writeText(link).then(() => {
                        showShareModal();
                    }, (err) => {
                        fallbackCopyTextToClipboard(link);
                        showShareModal();
                    });
                } else {
                    fallbackCopyTextToClipboard(link);
                    showShareModal();
                }
            });

            // Close modal button event listener
            closeModalBtn.addEventListener('click', () => {
                messageModal.classList.add('hidden');
            });

            // --- URL Parameter Handling for Shared View ---
            const urlParams = new URLSearchParams(window.location.search);
            const sharedScore = urlParams.get('score');

            if (sharedScore) {
                gameContainer.classList.add('hidden');
                sharedScoreContainer.classList.remove('hidden');
                sharedScoreElement.textContent = sharedScore;
                shareBtn.classList.add('hidden');
            } else {
                gameContainer.classList.remove('hidden');
                sharedScoreContainer.classList.add('hidden');
                shareBtn.classList.remove('hidden');
            }

            // Play Now button action (for the shared view)
            playNowBtn.addEventListener('click', () => {
                window.location.href = window.location.pathname; // Reload the page without the score parameter
            });
            // ----------------------------------------------

            // Attach event listeners for the game
            optionButtons.forEach(btn => {
                btn.addEventListener('click', handleOptionClick);
            });

            nextSituationBtn.addEventListener('click', () => {
                currentSituationIndex++;
                loadSituation();
            });

            // Initial load only if not in shared view
            if (!sharedScore) {
                loadSituation();
            }
        });
    </script>
</div>